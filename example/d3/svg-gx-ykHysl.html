<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>业扩-行业受理工单</title>
    <style>
    #test {
        width: 80%;
        height: 400px;
        margin: 0 auto;
        background-color:rgb(0, 0, 0);
    }
    #myForm{
      text-align: center;
    }

      .cls-1, .cls-2, .cls-3, .cls-4, .cls-5, .cls-6 {
        fill: #6cf;
      }

      .cls-1, .cls-2 {
        fill-opacity: 0.05;
      }

      .cls-1, .cls-10, .cls-11, .cls-12, .cls-13, .cls-14, .cls-2, .cls-3, .cls-4, .cls-5, .cls-6 {
        fill-rule: evenodd;
      }

      .cls-2 {
        filter: url(#filter);
      }

      .cls-3 {
        filter: url(#filter-2);
      }

      .cls-4 {
        filter: url(#filter-3);
      }

      .cls-5 {
        filter: url(#filter-4);
      }

      .cls-6 {
        filter: url(#filter-5);
      }

      .cls-7 {
        font-size: 20px;
      }

      .cls-7, .cls-8 {
        opacity: 0.8;
        font-family: "Microsoft YaHei";
        font-weight: 700;
      }

      .cls-7, .cls-8, .cls-9 {
        fill: #fff;
      }

      .cls-8 {
        font-size: 16px;
      }

      .cls-9 {
        font-size: 28px;
        filter: url(#filter-6);
        font-family: Impact;
      }

      .cls-10 {
        fill: #a273ff;
        filter: url(#filter-7);
      }

      .cls-11 {
        fill: #4aa4ff;
        filter: url(#filter-8);
      }

      .cls-12 {
        fill: #65fcfc;
        filter: url(#filter-9);
      }

      .cls-13 {
        fill: #61fa7b;
        filter: url(#filter-10);
      }

      .cls-14 {
        fill: #fae061;
        filter: url(#filter-11);
      }
      #text{
        width: 50%;
      }
    </style>
</head>
<body>
<div id="test">
    <svg id="组_11" data-name="组 11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="329" height="118" viewBox="0 0 329 118">
<defs>
	<clipPath id="clipPath">
		<path class="layer"/>
	</clipPath>
	
    <filter id="filter" x="3773" y="1153" width="304" height="108" filterUnits="userSpaceOnUse">
      <feOffset result="offset" dy="2" in="SourceAlpha"/>
      <feGaussianBlur result="blur" stdDeviation="3.162"/>
      <feFlood result="flood" flood-opacity="0.2"/>
      <feComposite result="composite" operator="in" in2="blur"/>
      <feBlend result="blend" in="SourceGraphic"/>
    </filter>
    <filter id="filter-2" x="3799" y="1146" width="32" height="24" filterUnits="userSpaceOnUse">
      <feGaussianBlur result="blur" stdDeviation="3.333" in="SourceAlpha"/>
      <feComposite result="composite"/>
      <feComposite result="composite-2"/>
      <feComposite result="composite-3"/>
      <feFlood result="flood" flood-color="#6cf" flood-opacity="0.4"/>
      <feComposite result="composite-4" operator="in" in2="composite-3"/>
      <feBlend result="blend" in2="SourceGraphic"/>
      <feBlend result="blend-2" in="SourceGraphic"/>
    </filter>
    <filter id="filter-3" x="3760" y="1240" width="32" height="24" filterUnits="userSpaceOnUse">
      <feGaussianBlur result="blur" stdDeviation="3.333" in="SourceAlpha"/>
      <feComposite result="composite"/>
      <feComposite result="composite-2"/>
      <feComposite result="composite-3"/>
      <feFlood result="flood" flood-color="#6cf" flood-opacity="0.4"/>
      <feComposite result="composite-4" operator="in" in2="composite-3"/>
      <feBlend result="blend" in2="SourceGraphic"/>
      <feBlend result="blend-2" in="SourceGraphic"/>
    </filter>
    <filter id="filter-4" x="4057" y="1146" width="32" height="24" filterUnits="userSpaceOnUse">
      <feGaussianBlur result="blur" stdDeviation="3.333" in="SourceAlpha"/>
      <feComposite result="composite"/>
      <feComposite result="composite-2"/>
      <feComposite result="composite-3"/>
      <feFlood result="flood" flood-color="#6cf" flood-opacity="0.4"/>
      <feComposite result="composite-4" operator="in" in2="composite-3"/>
      <feBlend result="blend" in2="SourceGraphic"/>
      <feBlend result="blend-2" in="SourceGraphic"/>
    </filter>
    <filter id="filter-5" x="4018" y="1240" width="32" height="24" filterUnits="userSpaceOnUse">
      <feGaussianBlur result="blur" stdDeviation="3.333" in="SourceAlpha"/>
      <feComposite result="composite"/>
      <feComposite result="composite-2"/>
      <feComposite result="composite-3"/>
      <feFlood result="flood" flood-color="#6cf" flood-opacity="0.4"/>
      <feComposite result="composite-4" operator="in" in2="composite-3"/>
      <feBlend result="blend" in2="SourceGraphic"/>
      <feBlend result="blend-2" in="SourceGraphic"/>
    </filter>
    <filter id="filter-6" x="203" y="18" width="61" height="43" filterUnits="userSpaceOnUse">
      <feGaussianBlur result="blur" stdDeviation="3.333" in="SourceAlpha"/>
      <feComposite result="composite"/>
      <feComposite result="composite-2"/>
      <feComposite result="composite-3"/>
      <feFlood result="flood" flood-color="#fec" flood-opacity="0.2"/>
      <feComposite result="composite-4" operator="in" in2="composite-3"/>
      <feBlend result="blend" in2="SourceGraphic"/>
      <feBlend result="blend-2" in="SourceGraphic"/>
    </filter>
    <filter id="filter-7" class="filter" x="3789" y="1202" filterUnits="userSpaceOnUse">
      <feOffset result="offset" dy="7" in="SourceAlpha"/>
      <feGaussianBlur result="blur" stdDeviation="3.464"/>
      <feFlood result="flood" flood-opacity="0.3"/>
      <feComposite result="composite" operator="in" in2="blur"/>
      <feBlend result="blend" in="SourceGraphic"/>
    </filter>
    <filter id="filter-8" class="filter" x="3828" y="1202" filterUnits="userSpaceOnUse">
      <feOffset result="offset" dy="7" in="SourceAlpha"/>
      <feGaussianBlur result="blur" stdDeviation="3.464"/>
      <feFlood result="flood" flood-opacity="0.3"/>
      <feComposite result="composite" operator="in" in2="blur"/>
      <feBlend result="blend" in="SourceGraphic"/>
    </filter>
    <filter id="filter-9" class="filter" x="3857" y="1202" filterUnits="userSpaceOnUse">
      <feOffset result="offset" dy="7" in="SourceAlpha"/>
      <feGaussianBlur result="blur" stdDeviation="3.464"/>
      <feFlood result="flood" flood-opacity="0.3"/>
      <feComposite result="composite" operator="in" in2="blur"/>
      <feBlend result="blend" in="SourceGraphic"/>
    </filter>
    <filter id="filter-10" class="filter" x="3906" y="1202" filterUnits="userSpaceOnUse">
      <feOffset result="offset" dy="7" in="SourceAlpha"/>
      <feGaussianBlur result="blur" stdDeviation="3.464"/>
      <feFlood result="flood" flood-opacity="0.3"/>
      <feComposite result="composite" operator="in" in2="blur"/>
      <feBlend result="blend" in="SourceGraphic"/>
    </filter>
    <filter id="filter-11" class="filter" x="3975" y="1202" filterUnits="userSpaceOnUse">
      <feOffset result="offset" dy="7" in="SourceAlpha"/>
      <feGaussianBlur result="blur" stdDeviation="3.464"/>
      <feFlood result="flood" flood-opacity="0.3"/>
      <feComposite result="composite" operator="in" in2="blur"/>
      <feBlend result="blend" in="SourceGraphic"/>
    </filter>
  </defs>
  <g id="组_796" data-name="组 796">
    <path id="矩形_1485" data-name="矩形 1485" class="cls-1" d="M3810,1155h269l-40,99H3770Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝_3" data-name="矩形 1485 拷贝 3" class="cls-2" d="M3818,1160h249l-36,89H3782Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485-2" data-name="矩形 1485" class="cls-3" d="M3811,1155h10l-3,5h-10Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝" data-name="矩形 1485 拷贝" class="cls-4" d="M3772,1249h10l-3,5h-10Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝_2" data-name="矩形 1485 拷贝 2" class="cls-5" d="M4069,1155h10l-3,5h-10Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝_2-2" data-name="矩形 1485 拷贝 2" class="cls-6" d="M4030,1249h10l-3,5h-10Z" transform="translate(-3760 -1146)"/>
  </g>
  <text id="行业受理工单" class="cls-7" x="62" y="46">行业受理工单</text>
  <text id="宗" class="cls-8" x="261.001" y="49">宗</text>
  <text id="_624" data-name="624" class="cls-9" x="210.999" y="50">624</text> 
  <g class="paths" clip-path="url(#clipPath)">
	<path id="矩形_1485_拷贝_4" data-name="矩形 1485 拷贝 4" class="cls-10" d="M3811,1206h36l-11,29h-36Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝_5" data-name="矩形 1485 拷贝 5" class="cls-11" d="M3850,1206h26l-11,29h-26Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝_6" data-name="矩形 1485 拷贝 6" class="cls-12" d="M3879,1206h46l-11,29h-46Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝_7" data-name="矩形 1485 拷贝 7" class="cls-13" d="M3928,1206h66l-11,29h-66Z" transform="translate(-3760 -1146)"/>
    <path id="矩形_1485_拷贝_8" data-name="矩形 1485 拷贝 8" class="cls-14" d="M3997,1206h36l-11,29h-36Z" transform="translate(-3760 -1146)"/>
  </g>
</svg>


</div>

<div id="myForm">
    <input type="text" id="text" placeholder="请输入数组例如:[10,20,30,20,20]"/>
    <!--
    <div style="color: #fff">
        <input type="radio" name="flag" value="0" checked>顺
        <input type="radio" name="flag" value="1">逆
    </div>
    -->
    <!-- <div>
        <input type="range" name="points" min="0" max="100%" value="80%" id="range"/>
    </div> -->
    <button id="change">变</button>
</div>

<script src="../../js/d3.js"></script>
<script>
/*
    *  @param id  id值，如本例使用的#test
    *  @param value 变化的最终值
    */
    function draw(paramsObj) {
        var id = paramsObj.id;
        var progress = paramsObj.value;
        var svg = d3.select(id).select("svg");
        var currentValue = svg.attr("data-value") || 0;
        svg.attr('data-value', progress);
        var text = d3.select('#center-text');
		//线性比例尺
		var linear = d3.scaleLinear()
			.domain([0, 100])
			.range([0, 210]);
		//区域生成器
		var areaPath = d3.area()
			.y(function(d,i){return i*100})
			.x0(function(d,i){return 30})
			.x1(function(d,i){return 0+d});
			
		var dataArr1 = [20,20,20,20,20];
		var dataArr2 = [5,5,5,5,80];
		// var progress = [1.14,12.38,21.9,31.428,17.14];
		var map = getPath2(progress);
		var paths = map.get('paths');
		var filterXs = map.get('filterXs');
		console.log(map);
		var pathSvg = svg.select('.paths').selectAll('path');
		var filterSvg = d3.select('defs').selectAll('.filter');
		pathSvg.data(paths).attr('d',function(d){return d});
		filterSvg.data(filterXs).attr('x',function(d){return d});

        var clipPath = svg.select('.layer');
        clipPath
			.transition()
            .duration(2000)
            .attrTween('d', tween);

        function tween() {
            var i = d3.interpolate(0,300);
            return function (t) {
                return areaPath([i(t),i(t)]);
            };
        }
		// function getPath(dataArr){
		// 	var paths = [];
		// 	var dataArr1 = [17.14,12.38,21.9,31.428,17.14];
		// 	var dataArr = [20,20,20,20,20];
		// 	var dataArr2 = [5,5,5,5,80];
		// 	var data1 = linear(dataArr[0]);
		// 	var data2 = linear(dataArr[1]);
		// 	var data3 = linear(dataArr[2]);
		// 	var data4 = linear(dataArr[3]);
		// 	var data5 = linear(dataArr[4]);
		// 	var path1 = 'M3811,1206h'+data1+'l-11,29h-'+data1+'Z';
		// 	var path2 = 'M'+(3811+data1+3)+',1206h'+data2+'l-11,29h-'+data2+'Z';
		// 	var path3 = 'M'+(3811+data1+3+data2+3)+',1206h'+data3+'l-11,29h-'+data3+'Z';
		// 	var path4 = 'M'+(3811+data1+3+data2+3+data3+3)+',1206h'+data4+'l-11,29h-'+data4+'Z';
		// 	var path5 = 'M'+(3811+data1+3+data2+3+data3+3+data4+3)+',1206h'+data5+'l-11,29h-'+data5+'Z';
		// 	paths.push(path1);
		// 	paths.push(path2);
		// 	paths.push(path3);
		// 	paths.push(path4);
		// 	paths.push(path5);
		// 	return paths;
    // }
      function getPath2(dataArr){
        var map= new Map();
        var paths = [];
        var filterXs = [];
        var sumData = 0;
        for(var i=0;i<dataArr.length;i++){
          var data=linear(dataArr[i]);
          var fliterX=3789+sumData;
          var path = 'M'+(3811+sumData)+',1206h'+data+'l-11,29h-'+data+'Z';
          paths.push(path);
          filterXs.push(fliterX);
          sumData+=(data+3)
        }
        map.set('paths',paths);
        map.set('filterXs',filterXs);
        return map;
      }
    }

    var btn = document.getElementById('change');
	  var dataArr = [10.14,12.38,21.9,31.428,17.14];
    draw({id: "#test", value: dataArr});
    btn.addEventListener("click", function () {
        var input = document.getElementById('text').value;
        try{
          if(!JSON.parse(input)) throw "请输入正确格式数组！";
        }catch(error){
          alert("请输入正确格式数组！")
          return false
        }
        input = JSON.parse(input);
        if(input.length != 5){
          alert("请输入数组长度为5的数组！")
          return false;
        }
        draw({id: "#test", value: input});
    }, false);
    // range.addEventListener("change", function () {
    //     var input1 = document.getElementById('text');
    //     input1.value = range.value;
    //     draw({id: "#test", value: range.value});
    // })

</script>
</body>
</html>